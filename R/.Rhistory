cv.error.10[i] = cv.glm(Auto, glm.fit, K=10)$delta[1]
}
cv.error.10
for (i in 1:10) {
glm.fit = glm(mpg ~ poly(horsepower, i), data=Auto)
cv.error.10[i] = cv.glm(Auto, glm.fit, K=10)$delta[1]
}
cv.error.10
head(Portfolio)
?Portfolio
summary(Portfolio)
alpha.fn = function(data, index) {
X = data$X[index]
Y = data$Y[index]
return((var(Y) - cov(X, Y)) / (var(X) + var(Y) - 2 * cov(X, Y)))
}
alpha.fn(Portfolio, 1:1000)
alpha.fn(Portfolio, 1:100)
X = data$X[1:100]
boot(Portfolio, alpha.fn, R=1000)
boot.fn = function(data, index) {
return(coef(lm(mpg ~ horsepower, data=data, subset=index)))
}
head(Auto)
names(Auto)
dim(Auto)
boot.fn(Auto, 1:392)
set.seed(1)
boot.fn(Auto, sample(392, 392, replace=T))
boot.fn(Auto, sample(392, 392, replace=T))
boot(Auto, boot.fn, 1000)
summary(lm(mpg ~ horsepower, data=Auto))$coef
?I
boot.fn = function(data, index) {
return(coef(lm(mpg ~ horsepower + I(horsepower^2), data=data, subset=Index)))
}
set.seed(1)
boot(Auto, boot.fn, 1000)
boot.fn = function(data, index) {
return(coef(lm(mpg ~ horsepower + I(horsepower^2), data=data, subset=index)))
}
set.seed(1)
boot(Auto, boot.fn, 1000)
summary(lm(mpg ~ horsepower + I(horsepower^2), data=data))$coef
summary(lm(mpg ~ horsepower + I(horsepower^2), data=Auto))$coef
install.packages("shiny")
library(shiny)
a <- matrix(1:10, 5, 2)
a
a <- matrix(c(0.338, 0.391, 0.369, 0.313, 0.361, ))
a <- matrix(c(0.338, 0.391, 0.369, 0.313, 0.361, 0.54, 0.45, 0.374, 0.447, 0.5))
a <- matrix(c(0.338, 0.391, 0.369, 0.313, 0.361, 0.54, 0.45, 0.374, 0.447, 0.5), 5, 2)
a
b <- matrix(c(2737.77, 1584.91))
b
a * b
a %*% b
c <- a %*% b
c - 804.63
c <- c - 804.63
c
d <- matrix(c(1400000, 1065000, 295000, 800000, 300000))
d % c
d / c
teamRank = c(1,2,3,3,4,4,4,4,5,5)
r2012 <- c(94, 88, 95, 88, 93, 94, 98, 97, 93, 94)
r2013 <- c(97, 97, 92, 93, 92, 96, 94, 96, 92, 90)
cor(teamRank, r2012)
cor(teamRank, r2013)
library(manipulate)
myPlot <- function(s) {
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
abline(0, s)
}
myPlot(3)
manipulate(myPlot(s), slider = x(0, 2, step = 0.1))
manipulate(myPlot(s), s = slider(0, 2, step = 0.1))
dTable(airquality, sPaginationType = "full_numbers")
airquality
library(rCharts)
dTable(airquality, sPaginationType = "full_numbers")
ls
a <- 1:30
b <- 5:35
a - b
b - a
head(a)
head(b)
class(a)
setdiff(a, b)
data(mtcars)
head(airquality)
head(airquality)
nrow(airquality)
xcomplete.cases(airquality)
x <- airquality[complete.cases(airquality), ]
nrow(x)
data(airquality)
cor(airquality)
head(airquality)
min(Ozone)
min(airquality$Ozone)
plot(Solar.R ~ Wind, airquality)
head(airquality)
library(ggplot2)
ggplot(airquality) +
geom_point(aes(x = Wind, y = Ozone, fill = Month))
ggplot(airquality) +
geom_point(aes(x = Wind, y = Ozone, color = Month))
ggplot(airquality) +
geom_point(aes(x = Wind, y = Ozone)) +
facet_grid(Month ~ .)
head(airquality)
cor(airquality, na.rm = T)
cor(airquality, rm.na = T)
cor(airquality)
x <- airquality[complete.cases(airquality), ]
x <- cor(airquality)
cor(x)
head(x)
x <- airquality[complete.cases(airquality), ]
head(x)
cor(x)
ggplot(x) +
geom_point(aes(x = Temp, y = Ozone))
ggplot(x) +
geom_point(aes(x = Temp, y = Ozone)) +
facet_grid(Month ~ .)
a <- 1:30
b <- 5:35
setdiff(a, b)
a
b
a - b
setdiff(b, a)
a[a %in% b]
a[!(a %in% b)]
subset(airquality, na = TRUE)
subset(airquality, nm = TRUE)
subset(airquality, complete.cases(airquality))
subset(airquality, !complete.cases(airquality))
g = D(x^2 ~ x)
install.packages('mosaic')
library(mosaic)
g = D(x^2 ~ x)
g
g(2)
D(sin(x) ~ x)
D(cos(x) ~ x)
h <- D(sin(abs(x - 3)) ~ x)
h
h(2)
sin(90)
?since
?sin
waterLM <- lm(y ~ A * B * C)
A <- c(-1, -1, -1, +1)
B <- c(-1, +1, -1, +1)
C <- c(-1, -1, +1, +1)
y <- c(30, 6, 4, 8)
waterLM <- lm(y ~ A * B * C)
summary(waterLM)
x <- c(1, 2, 3, 4)
sd(x)
update.packages()
rm(list = ls())
?aggregate
rm(list = ls())
library(DBI)
rm(list = ls())
getwd()
library(leafletR)
library(rgdal) #for reading/writing geo files
install.packages('rgdal')
install.packages(geos, type="source")
install.packages('geos', type="source")
install.packages('rgdal', type="source")
library(rgdal) #for reading/writing geo files
install.packages('geos', type="source")
install.packages('geos')
library(leaftlet)
library(leaftletR)
library(leafletR)
library(leaftlet)
install.packages('leaflet')
detach('package:leafletR')
if(!require(devtools)) install.packages("devtools")
if(!require(leaflet)) install_github("rstudio/leaflet")
library(leaflet)
if(!require(leaflet)) install_github("rstudio/leaflet")
(m <- leaflet() %>% addTiles())
(m <- leaflet() %>% addTiles())
install_github("rstudio/leaflet")
library(leaflet)
(m <- leaflet() %>% addTiles())
m <- leaflet() %>% addTiles()
m
(m)
img <- readPNG("~/repos/Creating-maps-in-R/figure//shiny_world.png")
m
library(RCurl) # download https data
urlfile <- 'https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data'
x <- getURL(urlfile, ssl.verifypeer = FALSE)
adults <- read.csv(textConnection(x), header=F)
# if the above getURL command fails, try this:
# adults <-read.csv('https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data', header=F)
names(adults)=c('Age','Workclass','FinalWeight','Education','EducationNumber',
'MaritalStatus','Occupation','Relationship','Race',
'Sex','CapitalGain','CapitalLoss','HoursWeek',
'NativeCountry','Income')
adults$Income <- ifelse(adults$Income==' <=50K',0,1)
library(caret)
dmy <- dummyVars(" ~ .", data = adults)
adultsTrsf <- data.frame(predict(dmy, newdata = adults))
## Correlation matrix with p-values. See http://goo.gl/nahmV for documentation of this function
cor.prob <- function (X, dfr = nrow(X) - 2) {
R <- cor(X, use="pairwise.complete.obs")
above <- row(R) < col(R)
r2 <- R[above]^2
Fstat <- r2 * dfr/(1 - r2)
R[above] <- 1 - pf(Fstat, 1, dfr)
R[row(R) == col(R)] <- NA
R
}
## Use this to dump the cor.prob output to a 4 column matrix
## with row/column indices, correlation, and p-value.
## See StackOverflow question: http://goo.gl/fCUcQ
flattenSquareMatrix <- function(m) {
if( (class(m) != "matrix") | (nrow(m) != ncol(m))) stop("Must be a square matrix.")
if(!identical(rownames(m), colnames(m))) stop("Row and column names must be equal.")
ut <- upper.tri(m)
data.frame(i = rownames(m)[row(m)[ut]],
j = rownames(m)[col(m)[ut]],
cor=t(m)[ut],
p=m[ut])
}
x <- cor.prob(adultsTrsf)
head(x)
library(caret)
remove(list=ls9)
remove(list=ls())
library(caret)
remove(list=ls())
names(getModelInfo())
names(getModelInfo())
library(RCurl)
urlfile <-'https://raw.githubusercontent.com/hadley/fueleconomy/master/data-raw/vehicles.csv'
?getURL
x <- getURL(urlfile, ssl.verifypeer = FALSE)
class(x)
head(x)
vehicles <- read.csv(textConnection(x))
head(vehicles)
dim(vehicles)
?repeat
?repeat
remove(list=ls())
titanicDF <- read.csv('http://math.ucdenver.edu/RTutorial/titanic.txt',sep='\t')
head(titanicDF)
titanicDF$Title <- ifelse(grepl('Mr ',titanicDF$Name),'Mr',ifelse(grepl('Mrs ',titanicDF$Name),'Mrs',ifelse(grepl('Miss',titanicDF$Name),'Miss','Nothing')))
titanicDF$Title <- as.factor(titanicDF$Title)
titanicDF$Age[is.na(titanicDF$Age)] <- median(titanicDF$Age, na.rm=T)
titanicDF <- titanicDF[c('PClass', 'Age',    'Sex',   'Title', 'Survived')]
require(caret)
titanicDummy <- dummyVars("~.",data=titanicDF, fullRank=F)
titanicDF <- as.data.frame(predict(titanicDummy,titanicDF))
head(titanicDF)
summary(titanicDF)
df_survived_1 <- subset(titanicDF, Survived==1)
df_survived_0 <- subset(titanicDF, Survived==0)
summary(df_survived_1$Sex.female)
summary(df_survived_0$Sex.female)
class(summary(df_survived_0$Sex.female))
Sex.Female_0 <- (summary(df_survived_0$Sex.female))
Sex.Female_0
class(Sex.Female_0)
Sex.Female_0 <- summary(df_survived_0$Sex.female)
class(Sex.Female_0)
Sex.Female_0
Sex.Female_0 <- c(Sex.Female_0[1:6])
Sex.Female_0
class(Sex.Female_0)
Sex.Female_0 <- as.numeric(summary(df_survived_0$Sex.female))
Sex.Female_0
Sex.Female_0 <- summary(df_survived_0$Sex.female)
Sex.Female_0 <- c(Sex.Female_0[1:6])
Sex.Female_1 <- (summary(df_survived_1$Sex.female))
Sex.Female_1 <- c(Sex.Female_1[1:6])
stats <- data.frame('ind'=c(1:6),
'Sex.Female_1'=Sex.Female_1,
'Sex.Female_0'=Sex.Female_0)
stats
Sex.Female_1
str(Sex.Female_1)
class(Sex.Female_1)
names(Sex.Female_1)
Sex.Female_1 <- summary(df_survived_1$Sex.female)
Sex.Female_1 <- c(Sex.Female_1)
Sex.Female_1
class(Sex.Female_1)
Sex.Female_0 <- c(Sex.Female_0)
stats <- data.frame('ind'=c(1:6),
'Sex.Female_1'=Sex.Female_1,
'Sex.Female_0'=Sex.Female_0)
stats
require(ggplot2)
p <- ggplot(data=stats, aes(ind)) +
geom_line(aes(y = Sex.Female_1, colour = "Sex.Female_1")) +
geom_line(aes(y = Sex.Female_0, colour = "Sex.Female_0")) +
scale_x_discrete(breaks = 1:6,
labels=c("min","1q","median","mean","3q","max"))
p
rm(list = ls())
getwd()
setwd('/Users/hawooksong/Desktop/shinyDE')
library(shiny)
runApp()
rm(list = ls())
runApp()
setwd('/Users/hawooksong/Desktop/shinyDE/R')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_bar()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_bar(stat='bin')
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_bar(stat='identity')
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_bar(stat='identity') +
ylim(c(0, 20))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_bar(stat='identity')
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_density()
ggplot(mtcars, aes(x=wt)) +
geom_density()
ggplot(mtcars, aes(x=wt)) +
geom_density() +
ylim(c(0, 20))
ggplot(mtcars, aes(x=wt)) +
geom_density()
ggplot(mtcars, aes(x=wt)) +
geom_density() +
ylim(c(0, 0.2))
ggplot(mtcars, aes(x=wt)) +
geom_boxplot()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_boxplot()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_boxplot() +
ylim(c(0, 4))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_path()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_path() +
ylim(c(0, 4))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_path()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_path() +
ylim(c(0, 4))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_path()
runApp()
runApp()
runApp()
runApp()
rm(list = ls())
runApp()
runApp()
runApp()
runApp()
runApp()
rm(list = ls())
runApp()
runApp()
runApp()
## widgetsReady reactives goes here!!!!!
## widgetsReady reactives goes here!!!!!## plot reactive
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
head(mtcars)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_point(aes(shape(as.factor(vs))))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_point(aes(shape=as.factor(vs)))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_point(aes(shape=as.factor(vs))) +
guides(shape = guide_legend(title='hi'))
ggplot(mtcars, aes(x=cyl, y=wt)) +
geom_point(aes(shape=as.factor(vs))) +
guides(shape = guide_legend(title=NULL))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
rm(list = ls())
runApp()
runApp()
runApp()
ggplot(mtcars, aes(x=mpg, y=mpg)) + geom_line(aes(group=NULL))
runApp()
runApp()
rm(list = ls())
runApp()
setwd('/Users/hawooksong/Desktop/Fenix Technical Exercise')
data <- read.csv('Technical Exercise Payment Data.csv', stringsAsFactor=FALSE)
head(data)
str(data)
getwd()
setwd('/Users/hawooksong/Desktop/shinyDE')
runApp()
library(shiny)
setwd('/Users/hawooksong/Desktop/shinyDE/R')
runApp()
runApp()
runApp()
setwd('/Users/hawooksong/Desktop/shinyDE/R')
runApp()
ensureProperVarName <- function(colnames, var, y) {
if (tolower(var) %in% c('none', '.')) return(var)
origVar <- var
## only if original variable is not found in dataset's column names
if (!(var %in% colnames)) {
## this step will do the following: e.g. y=='mpg' to y=='mpg_mean'
var <- colnames[grepl(var, colnames)]
## if no match found
if (length(var)==0L) {
if (('count' %in% colnames))
var <- 'count'
else
var <- origVar
}
}
return(var)
}
runApp()
runApp()
runApp()
runApp()
runApp()
